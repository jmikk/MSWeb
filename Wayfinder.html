<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advisory Curriculum Dashboard</title>
    <style>
        :root {
            --bg: #f1f5f9; --card: #ffffff; --primary: #6366f1;
            --today-border: #6366f1; --today-bg: #eef2ff;
            --belonging: #dcfce7; --independence: #e0f2fe; --mastery: #fef3c7; --generosity: #fce7f3;
        }
        body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); padding: 20px; color: #334155; }
        .container { max-width: 1200px; margin: 0 auto; }
        
        /* Navigation Header */
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; background: white; padding: 15px 25px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .month-title { font-size: 1.5rem; font-weight: 800; color: #1e293b; margin: 0; text-transform: capitalize; }
        .nav-btn { background: #f8fafc; border: 1px solid #e2e8f0; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.2s; }
        .nav-btn:hover { background: var(--primary); color: white; }

        .calendar-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        .col-header { text-align: center; margin-bottom: 5px; }
        .pillar-tag { display: block; font-size: 0.6rem; font-weight: 800; text-transform: uppercase; padding: 8px; border-radius: 8px 8px 0 0; letter-spacing: 1px; }
        .day-name { display: block; background: #fff; padding: 4px; font-weight: 600; font-size: 0.8rem; border-radius: 0 0 8px 8px; border: 1px solid #f1f5f9; }

        .card { 
            background: var(--card); border-radius: 10px; padding: 12px; min-height: 110px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: flex; flex-direction: column;
            border: 2px solid transparent; position: relative;
        }
        .card.is-today { border-color: var(--today-border); background: var(--today-bg); transform: scale(1.02); z-index: 5; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .card.is-today::after { content: "TODAY"; position: absolute; top: -10px; right: 10px; background: var(--primary); color: white; font-size: 0.6rem; padding: 2px 8px; border-radius: 10px; font-weight: 800; }
        
        .card.empty { opacity: 0.4; background: #f8fafc; border: 1px dashed #cbd5e1; }
        .date-num { font-weight: 800; color: #94a3b8; font-size: 0.9rem; margin-bottom: 5px; }
        .task-text { font-size: 0.85rem; font-weight: 600; line-height: 1.3; flex-grow: 1; color: #1e293b; }
        
        .link-btn { margin-top: 8px; display: block; background: var(--primary); color: white; text-align: center; text-decoration: none; padding: 6px; border-radius: 5px; font-size: 0.7rem; font-weight: 700; }

        @media (max-width: 800px) { .calendar-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <button class="nav-btn" onclick="changeMonth(-1)">← Prev</button>
        <h1 class="month-title" id="monthDisplay">Month</h1>
        <button class="nav-btn" onclick="changeMonth(1)">Next →</button>
    </header>

    <div class="calendar-grid">
        <div class="col-header"><span class="pillar-tag" style="background:#e2e8f0">Mindfulness</span><span class="day-name">Monday</span></div>
        <div class="col-header"><span class="pillar-tag" style="background:var(--belonging)">Belonging</span><span class="day-name">Tuesday</span></div>
        <div class="col-header"><span class="pillar-tag" style="background:var(--independence)">Independence</span><span class="day-name">Wednesday</span></div>
        <div class="col-header"><span class="pillar-tag" style="background:var(--mastery)">Mastery</span><span class="day-name">Thursday</span></div>
        <div class="col-header"><span class="pillar-tag" style="background:var(--generosity)">Generosity</span><span class="day-name">Friday</span></div>
        <div id="calendar-body" style="display: contents;"></div>
    </div>
</div>

<script>
    let viewDate = new Date(); // Controls what month we are looking at

    async function renderCalendar() {
        const monthNames = ["january", "february", "march", "april", "may", "june", "july", "august", "september", "october", "november", "december"];
        const currentMonthIdx = viewDate.getMonth();
        const currentYear = viewDate.getFullYear();
        const monthName = monthNames[currentMonthIdx];

        // Update UI Header
        document.getElementById('monthDisplay').innerText = `${monthName} ${currentYear}`;

        // Fetch Month-Specific JSON
        let wayfinderData = [];
        try {
            const response = await fetch(`./data/wayfinder_${monthName}.json`);
            if (response.ok) wayfinderData = await response.json();
        } catch (e) { console.warn(`No data file found for ${monthName}`); }

        const calendarBody = document.getElementById('calendar-body');
        calendarBody.innerHTML = ''; // Clear current view
        
        const daysInMonth = new Date(currentYear, currentMonthIdx + 1, 0).getDate();
        const today = new Date();

        for (let d = 1; d <= daysInMonth; d++) {
            const dateObj = new Date(currentYear, currentMonthIdx, d);
            const dayOfWeek = dateObj.getDay();

            if (dayOfWeek === 0 || dayOfWeek === 6) continue; // Skip weekends

            // Padding for start of month
            if (d === 1 && dayOfWeek > 1) {
                for (let p = 1; p < dayOfWeek; p++) {
                    const pad = document.createElement('div');
                    pad.className = 'card empty';
                    calendarBody.appendChild(pad);
                }
            }

            const dayData = wayfinderData.find(item => parseInt(item.date) === d);
            const card = document.createElement('div');
            card.className = 'card';
            
            // Check if it is actually today
            if (dateObj.toDateString() === today.toDateString()) card.classList.add('is-today');
            if (dayData && dayData.status === 'no-school') card.classList.add('empty');

            const title = dayData ? dayData.title : "—";
            const link = dayData && dayData.link ? `<a href="${dayData.link}" class="link-btn" target="_blank">View Lesson</a>` : '';

            card.innerHTML = `<div class="date-num">${d}</div><div class="task-text">${title}</div>${link}`;
            calendarBody.appendChild(card);
        }
    }

    function changeMonth(offset) {
        viewDate.setMonth(viewDate.getMonth() + offset);
        renderCalendar();
    }

    renderCalendar();
</script>
</body>
</html>
