<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advisory Live Dashboard</title>
    <style>
        :root {
            --bg: #f1f5f9; --card: #ffffff; --primary: #6366f1;
            --today-border: #6366f1; --today-bg: #eef2ff;
            --belonging: #dcfce7; --independence: #e0f2fe; --mastery: #fef3c7; --generosity: #fce7f3;
        }
        body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); padding: 20px; color: #334155; }
        .container { max-width: 1200px; margin: 0 auto; }
        
        header { text-align: center; margin-bottom: 20px; }
        .month-title { font-size: 2rem; font-weight: 800; color: #1e293b; margin: 0; text-transform: capitalize; }

        /* Grid Layout */
        .calendar-grid { 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); /* School week only */
            gap: 10px; 
        }

        .col-header { text-align: center; margin-bottom: 5px; }
        .pillar-tag { 
            display: block; font-size: 0.6rem; font-weight: 800; text-transform: uppercase; 
            padding: 8px; border-radius: 8px 8px 0 0; letter-spacing: 1px;
        }
        .day-name { display: block; background: #fff; padding: 4px; font-weight: 600; font-size: 0.8rem; border-radius: 0 0 8px 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }

        /* Day Cards */
        .card { 
            background: var(--card); border-radius: 10px; padding: 12px; min-height: 100px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: flex; flex-direction: column;
            border: 2px solid transparent; position: relative;
        }
        .card.is-today { border-color: var(--today-border); background: var(--today-bg); transform: scale(1.02); z-index: 10; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .card.is-today::after { content: "TODAY"; position: absolute; top: -10px; right: 10px; background: var(--primary); color: white; font-size: 0.6rem; padding: 2px 8px; border-radius: 10px; font-weight: 800; }
        
        .card.weekend-placeholder { background: #f8fafc; opacity: 0.3; border: 1px dashed #cbd5e1; }
        .card.empty { opacity: 0.4; background: #f8fafc; }

        .date-num { font-weight: 800; color: #94a3b8; font-size: 0.9rem; margin-bottom: 5px; }
        .is-today .date-num { color: var(--primary); }
        
        .task-text { font-size: 0.85rem; font-weight: 600; line-height: 1.3; flex-grow: 1; color: #1e293b; }
        
        .link-btn { 
            margin-top: 8px; display: block; background: var(--primary); color: white; 
            text-align: center; text-decoration: none; padding: 6px; border-radius: 5px; 
            font-size: 0.7rem; font-weight: 700;
        }

        @media (max-width: 800px) {
            .calendar-grid { grid-template-columns: 1fr; }
            .pillar-tag { border-radius: 8px; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1 class="month-title" id="monthDisplay">Month</h1>
    </header>

    <div class="calendar-grid">
        <div class="col-header"><span class="pillar-tag" style="background:#e2e8f0">Mindfulness</span><span class="day-name">Mon</span></div>
        <div class="col-header"><span class="pillar-tag" style="background:var(--belonging)">Belonging</span><span class="day-name">Tue</span></div>
        <div class="col-header"><span class="pillar-tag" style="background:var(--independence)">Independence</span><span class="day-name">Wed</span></div>
        <div class="col-header"><span class="pillar-tag" style="background:var(--mastery)">Mastery</span><span class="day-name">Thu</span></div>
        <div class="col-header"><span class="pillar-tag" style="background:var(--generosity)">Generosity</span><span class="day-name">Fri</span></div>

        <div id="calendar-body" style="display: contents;"></div>
    </div>
</div>

<script>
    async function initCalendar() {
        const now = new Date();
        const currentMonth = now.getMonth();
        const currentYear = now.getFullYear();
        const todayDate = now.getDate();

        // Update Header
        const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        document.getElementById('monthDisplay').innerText = `${monthNames[currentMonth]} ${currentYear}`;

        // Fetch JSON Data
        let wayfinderData = [];
        try {
            const response = await fetch('./data/wayfinder.json');
            wayfinderData = await response.json();
        } catch (e) { console.error("Data load failed", e); }

        const calendarBody = document.getElementById('calendar-body');
        
        // Calendar Logic
        const firstDay = new Date(currentYear, currentMonth, 1).getDay(); // 0 (Sun) to 6 (Sat)
        const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

        // Generate the grid
        // We iterate through every day, but only display Mon-Fri (1-5)
        for (let d = 1; d <= daysInMonth; d++) {
            const dateObj = new Date(currentYear, currentMonth, d);
            const dayOfWeek = dateObj.getDay();

            // Skip Weekends
            if (dayOfWeek === 0 || dayOfWeek === 6) continue;

            // Handle start-of-month padding (if month doesn't start on Mon)
            if (d === 1 && dayOfWeek > 1) {
                for (let p = 1; p < dayOfWeek; p++) {
                    const pad = document.createElement('div');
                    pad.className = 'card empty';
                    calendarBody.appendChild(pad);
                }
            }

            // Find matching data in JSON
            const dayData = wayfinderData.find(item => parseInt(item.date) === d);
            
            // Create Card
            const card = document.createElement('div');
            card.className = 'card';
            if (d === todayDate) card.classList.add('is-today');
            if (dayData && dayData.status === 'no-school') card.classList.add('empty');

            const title = dayData ? dayData.title : "No activity scheduled";
            const link = dayData && dayData.link ? `<a href="${dayData.link}" class="link-btn" target="_blank">Activity</a>` : '';

            card.innerHTML = `
                <div class="date-num">${d}</div>
                <div class="task-text">${title}</div>
                ${link}
            `;
            calendarBody.appendChild(card);
        }
    }

    initCalendar();
</script>
</body>
</html>
